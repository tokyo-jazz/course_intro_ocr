# Решение

Как и в других задачах, я использую приведение исходного изображения к квадрату (паддинг до квадрата для сохранения геометрии, потом `resize`) + `resnet`. После `resnet` стоит линейный слой, который нормализуется во время `forward`, чтобы точка оказалась на сфере. В качестве loss-функции реализован `CosFace`; используются параметры `margin=0.35`, `s=64`. Текущая модель обучена на $20$ эпох.

Реализация `resnet` позаимствована отсюда https://github.com/kuangliu/pytorch-cifar/blob/master/models/resnet.py

Было обнаружено, что в половине неправильно классифицированных примеров правильный ответ находится в топ-2 вывода, а в $\frac{2}{3}$ случаев в топ-5. Поэтому дальнейшее усовершенствование могло бы состоять в дополнительном классификаторе на выходе на 2-5 элементов, который обучается на месте.
